{"changed":false,"filter":false,"title":"application_controller_spec.rb","tooltip":"/spec/controllers/application_controller_spec.rb","value":"require \"rails_helper\"\n\nRSpec.describe ApplicationController, type: :controller do\n  # create test user\n  let!(:user) { create(:user) }\n   # set headers for authorization\n  let(:headers) { { 'Authorization' => token_generator(user.id) } }\n  let(:invalid_headers) { { 'Authorization' => nil } }\n\n  describe \"#authorize_request\" do\n    context \"when auth token is passed\" do\n      before { allow(request).to receive(:headers).and_return(headers) }\n\n      # private method authorize_request returns current user\n      it \"sets the current user\" do\n        expect(subject.instance_eval { authorize_request }).to eq(user)\n      end\n    end\n\n    context \"when auth token is not passed\" do\n      before do\n        allow(request).to receive(:headers).and_return(invalid_headers)\n      end\n\n      it \"raises MissingToken error\" do\n        expect { subject.instance_eval { authorize_request } }.\n          to raise_error(ExceptionHandler::MissingToken, /Missing token/)\n      end\n    end\n  end\nend\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0.5,"scrollleft":0,"selection":{"start":{"row":30,"column":3},"end":{"row":30,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1550620658158}